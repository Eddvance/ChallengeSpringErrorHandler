<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>RFC Book Database</title>
    <link rel="stylesheet" th:href="@{/css/home-style.css}" />
</head>
<body>
<h1>Welcome to the RFC BOOK DATABASE</h1>
<p>
    This database contains information on various RFCs. Explore, search, and find details about each RFC document.
</p>

<button id="consultBook" class="button">Consult Books</button>

<a th:href="@{/create-form}" class="button">Add a New Book</a>

<div id="bookListContainer"></div>


<script>
    document.getElementById("consultBook").addEventListener("click", function(e) {
        e.preventDefault();  // Empêche le comportement par défaut si c'est dans un formulaire

        // Effectue une requête GET vers l'API REST pour récupérer la liste des livres
        fetch('/book/api/book')
            .then(response => {
                if (!response.ok) {
                    throw new Error("Erreur réseau : " + response.status);
                }
                return response.json();
            })
            .then(data => {
                const container = document.getElementById("bookListContainer");
                container.innerHTML = ""; // Vider le contenu précédent

                if (data.length === 0) {
                    container.innerHTML = "<p>No books found.</p>";
                } else {
                    data.forEach(book => {
                        // Crée un élément pour chaque livre
                        const bookItem = document.createElement("div");
                        bookItem.className = "book-item";
                        // Adaptez les propriétés en fonction de votre entité Book
                        bookItem.innerHTML = `
                <h3>${book.bookName}</h3>
                <p>Publication Year: ${book.publicationYear}</p>
                <p>Author: ${book.bookAuthor}</p>
              `;
                        container.appendChild(bookItem);
                    });
                }
            })
            .catch(error => {
                console.error("Error fetching books:", error);
                document.getElementById("bookListContainer").innerHTML = "<p>Error fetching books.</p>";
            });
    });
</script>
</body>
</html>